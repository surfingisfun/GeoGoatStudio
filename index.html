<!DOCTYPE html>
<html>
<head>
    <title>AR Geo-location based .obj model</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <script src="https://unpkg.com/aframe-geo-location-component@0.1.0/dist/aframe-geo-location-component.min.js"></script>

    <script>
        AFRAME.registerComponent('scale-on-distance', {
            schema: {
                minScale: {type: 'number', default: 0.05},
                maxScale: {type: 'number', default: 1.0},
                minDistance: {type: 'number', default: 1.0},
                maxDistance: {type: 'number', default: 10.0}
            },

            tick: function() {
                const cameraEl = document.querySelector('[camera]');
                const position = cameraEl.object3D.position;
                const distance = this.el.object3D.position.distanceTo(position);
                const scale = THREE.MathUtils.clamp(
                    (distance - this.data.minDistance) / (this.data.maxDistance - this.data.minDistance), 
                    0, 
                    1
                );
                const scaleVec = new THREE.Vector3().lerpVectors(
                    new THREE.Vector3().setScalar(this.data.minScale), 
                    new THREE.Vector3().setScalar(this.data.maxScale), 
                    scale
                );
                this.el.object3D.scale.copy(scaleVec);
            }
        });
    </script>
</head>
<body style='margin : 0px; overflow: hidden;'>
    <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false;'>
        <a-assets>
            <a-asset-item id="goat-model" src="https://surfingisfun.github.io/GeoGoatStudio/Goat.obj"></a-asset-item>
        </a-assets>
        
        <a-entity gps-projected-entity-place="latitude: 34.410861; longitude: -119.701004" gps-camera>
            <a-entity 
                id="goat"
                rotation="0 180 0"
                scale-on-distance="minScale: 0.01; maxScale: 1.0; minDistance: 1.0; maxDistance: 10.0"
                obj-model="obj: #goat-model;"
            ></a-entity>
        </a-entity>
    </a-scene>
</body>
</html>
